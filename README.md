# LTS-CG: Inferring Latent Temporal Sparse  Cooperative Graph for Multi-Agent Reinforcement Learning

This codebase is based on [PyMARL](https://github.com/oxwhirl/pymarl) and contains the implementation
of the [LTS-CG](https://arxiv.org/abs/2403.19253) algorithm.

<figure>
  <img src="https://github.com/Wei9711/LTSCG/raw/main/LTSCG.svg" alt="LTSCG Framework SVG">
  <figcaption>The framework of LTS-CG. LTS-CG samples a sparse graph from an agent-pair probability matrix generated by agents' observation trajectories. We further learn the graph to encode two essential characteristics: Predict-Future enables agents to predict future steps effectively, and Infer-Present empowers every partially observed agent to deduce the current state using graph information. The learned temporal graph structure captures past experiences, while current observations determine edge weights. This allows agents to exchange knowledge during policy learning and gain historical and present perspectives for effective cooperation. Graph learning and agent training occur simultaneously in an end-to-end fashion.
</figcaption>
</figure>




## Run an experiment 

Tasks can be found in `src/envs`. 

To run experiments on SMAC benchmark:
```shell
python src/main.py --config=ltscg --env-config=sc2 with env_args.map_name='10m_vs_11m' 
```
In most maps, just using **Infer-Present** decoder requires less training time:
```shell
python src/main.py --config=ltscg_inf --env-config=sc2 with env_args.map_name='10m_vs_11m' 
```

The requirements.txt file can be used to install the necessary packages into a virtual environment.

## Baselines used in this paper
- [**QMIX**: QMIX: Monotonic Value Function Factorisation for Deep Multi-Agent Reinforcement Learning](https://arxiv.org/abs/1803.11485)
- [**DCG**: Deep Coordination Graphs](https://arxiv.org/abs/1910.00091)
- [**DICG**: Deep Implicit Coordination Graphs for Multi-agent Reinforcement Learning](https://arxiv.org/abs/2006.11438) 
- [**SOP-CG**: Self-Organized Polynomial-Time Coordination Graphs](https://arxiv.org/abs/2112.03547)
- [**CASEC**: Context-Aware Sparse Deep Coordination Graphs](https://arxiv.org/abs/2106.02886)

## Citing LTS-CG 

If you use LTS-CG in your research, please cite the [LTS-CG paper](https://arxiv.org/abs/2403.19253).

*Wei Duan, Jie Lu, Junyu Xuan. Inferring Latent Temporal Sparse Coordination Graph for Multi-Agent Reinforcement Learning. CoRR abs/2403.19253 (2024)*

In BibTeX format:

```tex
@article{DBLP:journals/corr/abs-2403-19253,
  author       = {Wei Duan and
                  Jie Lu and
                  Junyu Xuan},
  title        = {Inferring Latent Temporal Sparse Coordination Graph for Multi-Agent
                  Reinforcement Learning},
  journal      = {CoRR},
  volume       = {abs/2403.19253},
  year         = {2024}
}

```

